import category_theory.monoidal.functor
universes v u
namespace category_theory
variables (C : Type u) [category.{v} C]
def endofunctor_monoidal_category : monoidal_category (C â¥¤ C) :=
{ tensor_obj   := Î» F G, F â‹™ G,
  tensor_hom   := Î» F G F' G' Î± Î², Î± â—« Î²,
  tensor_unit  := ğŸ­ C,
  associator   := Î» F G H, functor.associator F G H,
  left_unitor  := Î» F, functor.left_unitor F,
  right_unitor := Î» F, functor.right_unitor F, }.
open category_theory.monoidal_category
local attribute [instance] endofunctor_monoidal_category
local attribute [reducible] endofunctor_monoidal_category
@[simps]
def tensoring_right_monoidal [monoidal_category.{v} C] : monoidal_functor C (C â¥¤ C) :=
{ Îµ := (right_unitor_nat_iso C).inv,
  Î¼ := Î» X Y,
  { app := Î» Z, (Î±_ Z X Y).hom,
    naturality' := Î» Z Z' f, by { dsimp, rw associator_naturality, simp, } },
  Î¼_natural' := Î» X Y X' Y' f g, by { ext Z, dsimp,
    simp only [â†id_tensor_comp_tensor_id g f, id_tensor_comp, â†tensor_id, category.assoc,
      associator_naturality, associator_naturality_assoc], },
  associativity' := Î» X Y Z, by { ext W, dsimp, simp [pentagon], },
  left_unitality' := Î» X, by { ext Y, dsimp, rw [category.id_comp, triangle, â†tensor_comp], simp, },
  right_unitality' := Î» X,
  begin
    ext Y, dsimp,
    rw [tensor_id, category.comp_id, right_unitor_tensor_inv, category.assoc, iso.inv_hom_id_assoc,
      â†id_tensor_comp, iso.inv_hom_id, tensor_id],
  end,
  Îµ_is_iso := by apply_instance,
  Î¼_is_iso := Î» X Y,
@[simps] noncomputable
def unit_of_tensor_iso_unit (m n : M) (h : m âŠ— n â‰… ğŸ™_M) : F.obj m â‹™ F.obj n â‰… ğŸ­ C :=
F.Î¼_iso m n â‰ªâ‰« F.to_functor.map_iso h â‰ªâ‰« F.Îµ_iso.symm
@[simps] noncomputable
def equiv_of_tensor_iso_unit (m n : M) (hâ‚ : m âŠ— n â‰… ğŸ™_M) (hâ‚‚ : n âŠ— m â‰… ğŸ™_M)
  (H : (hâ‚.hom âŠ— ğŸ™ m) â‰« (Î»_ m).hom = (Î±_ m n m).hom â‰« (ğŸ™ m âŠ— hâ‚‚.hom) â‰« (Ï_ m).hom) : C â‰Œ C :=
{ functor := F.obj m,
  inverse := F.obj n,
  unit_iso := (unit_of_tensor_iso_unit F m n hâ‚).symm,
  counit_iso := unit_of_tensor_iso_unit F n m hâ‚‚,
  functor_unit_iso_comp' :=
  begin
    intro X,
    dsimp,
    simp only [Î¼_naturalityáµ£_assoc, Î¼_naturalityâ‚—_assoc, Îµ_inv_app_obj, category.assoc,
      obj_Î¼_inv_app, functor.map_comp, Î¼_inv_hom_app_assoc, obj_Îµ_app,
      unit_of_tensor_iso_unit_inv_app],
    simp [â† nat_trans.comp_app, â† F.to_functor.map_comp, â† H, - functor.map_comp]
  end }
end category_theory
