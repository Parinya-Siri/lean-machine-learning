import category_theory.isomorphism
import tactic.slice
namespace category_theory
universes w v u
open category iso
restate_axiom whisker_left_id'
restate_axiom whisker_left_comp'
restate_axiom id_whisker_left'
restate_axiom comp_whisker_left'
restate_axiom id_whisker_right'
restate_axiom comp_whisker_right'
restate_axiom whisker_right_id'
restate_axiom whisker_right_comp'
restate_axiom whisker_assoc'
restate_axiom whisker_exchange'
restate_axiom pentagon'
restate_axiom triangle'
attribute [simp]  pentagon triangle
attribute [reassoc]
  whisker_left_comp id_whisker_left comp_whisker_left
  comp_whisker_right whisker_right_id whisker_right_comp
  whisker_assoc whisker_exchange pentagon triangle
attribute [simp]
  whisker_left_id whisker_left_comp id_whisker_left comp_whisker_left
  id_whisker_right comp_whisker_right whisker_right_id whisker_right_comp
  whisker_assoc
attribute [instance] hom_category
variables {B : Type u} [bicategory.{w v} B] {a b c d e : B}
@[simp, reassoc]
lemma hom_inv_whisker_left (f : a âŸ¶ b) {g h : b âŸ¶ c} (Î· : g â‰… h) :
  f â— Î·.hom â‰« f â— Î·.inv = ğŸ™ (f â‰« g) :=
by rw [â†whisker_left_comp, hom_inv_id, whisker_left_id]
@[simp, reassoc]
lemma hom_inv_whisker_right {f g : a âŸ¶ b} (Î· : f â‰… g) (h : b âŸ¶ c) :
  Î·.hom â–· h â‰« Î·.inv â–· h = ğŸ™ (f â‰« h) :=
by rw [â†comp_whisker_right, hom_inv_id, id_whisker_right]
@[simp, reassoc]
lemma inv_hom_whisker_left (f : a âŸ¶ b) {g h : b âŸ¶ c} (Î· : g â‰… h) :
  f â— Î·.inv â‰« f â— Î·.hom = ğŸ™ (f â‰« h) :=
by rw [â†whisker_left_comp, inv_hom_id, whisker_left_id]
@[simp, reassoc]
lemma inv_hom_whisker_right {f g : a âŸ¶ b} (Î· : f â‰… g) (h : b âŸ¶ c) :
  Î·.inv â–· h â‰« Î·.hom â–· h = ğŸ™ (g â‰« h) :=
by rw [â†comp_whisker_right, inv_hom_id, id_whisker_right]
@[simps]
def whisker_left_iso (f : a âŸ¶ b) {g h : b âŸ¶ c} (Î· : g â‰… h) :
  f â‰« g â‰… f â‰« h :=
{ hom := f â— Î·.hom,
  inv := f â— Î·.inv }
instance whisker_left_is_iso (f : a âŸ¶ b) {g h : b âŸ¶ c} (Î· : g âŸ¶ h) [is_iso Î·] :
  is_iso (f â— Î·) :=
is_iso.of_iso (whisker_left_iso f (as_iso Î·))
@[simp]
lemma inv_whisker_left (f : a âŸ¶ b) {g h : b âŸ¶ c} (Î· : g âŸ¶ h) [is_iso Î·] :
  inv (f â— Î·) = f â— (inv Î·) :=
by { ext, simp only [â†whisker_left_comp, whisker_left_id, is_iso.hom_inv_id] }
@[simps]
def whisker_right_iso {f g : a âŸ¶ b} (Î· : f â‰… g) (h : b âŸ¶ c) :
  f â‰« h â‰… g â‰« h :=
{ hom := Î·.hom â–· h,
  inv := Î·.inv â–· h }
instance whisker_right_is_iso {f g : a âŸ¶ b} (Î· : f âŸ¶ g) (h : b âŸ¶ c) [is_iso Î·] :
  is_iso (Î· â–· h) :=
is_iso.of_iso (whisker_right_iso (as_iso Î·) h)
@[simp]
lemma inv_whisker_right {f g : a âŸ¶ b} (Î· : f âŸ¶ g) (h : b âŸ¶ c) [is_iso Î·] :
  inv (Î· â–· h) = (inv Î·) â–· h :=
by { ext, simp only [â†comp_whisker_right, id_whisker_right, is_iso.hom_inv_id] }
@[simp, reassoc]
lemma pentagon_inv (f : a âŸ¶ b) (g : b âŸ¶ c) (h : c âŸ¶ d) (i : d âŸ¶ e) :
  f â— (Î±_ g h i).inv â‰« (Î±_ f (g â‰« h) i).inv â‰« (Î±_ f g h).inv â–· i =
    (Î±_ f g (h â‰« i)).inv â‰« (Î±_ (f â‰« g) h i).inv :=
eq_of_inv_eq_inv (by simp)
@[simp, reassoc]
lemma pentagon_inv_inv_hom_hom_inv (f : a âŸ¶ b) (g : b âŸ¶ c) (h : c âŸ¶ d) (i : d âŸ¶ e) :
  (Î±_ f (g â‰« h) i).inv â‰« (Î±_ f g h).inv â–· i â‰« (Î±_ (f â‰« g) h i).hom =
    f â— (Î±_ g h i).hom â‰« (Î±_ f g (h â‰« i)).inv :=
by { rw [â†cancel_epi (f â— (Î±_ g h i).inv), â†cancel_mono (Î±_ (f â‰« g) h i).inv], simp }
@[simp, reassoc]
lemma pentagon_inv_hom_hom_hom_inv (f : a âŸ¶ b) (g : b âŸ¶ c) (h : c âŸ¶ d) (i : d âŸ¶ e) :
  (Î±_ (f â‰« g) h i).inv â‰« (Î±_ f g h).hom â–· i â‰« (Î±_ f (g â‰« h) i).hom =
    (Î±_ f g (h â‰« i)).hom â‰« f â— (Î±_ g h i).inv :=
eq_of_inv_eq_inv (by simp)
@[simp, reassoc]
lemma pentagon_hom_inv_inv_inv_inv (f : a âŸ¶ b) (g : b âŸ¶ c) (h : c âŸ¶ d) (i : d âŸ¶ e) :
  f â— (Î±_ g h i).hom â‰« (Î±_ f g (h â‰« i)).inv â‰« (Î±_ (f â‰« g) h i).inv =
    (Î±_ f (g â‰« h) i).inv â‰« (Î±_ f g h).inv â–· i :=
by simp [â†cancel_epi (f â— (Î±_ g h i).inv)]
@[simp, reassoc]
lemma pentagon_hom_hom_inv_hom_hom (f : a âŸ¶ b) (g : b âŸ¶ c) (h : c âŸ¶ d) (i : d âŸ¶ e) :
  (Î±_ (f â‰« g) h i).hom â‰« (Î±_ f g (h â‰« i)).hom â‰« f â— (Î±_ g h i).inv =
    (Î±_ f g h).hom â–· i â‰« (Î±_ f (g â‰« h) i).hom :=
eq_of_inv_eq_inv (by simp)
@[simp, reassoc]
lemma pentagon_hom_inv_inv_inv_hom (f : a âŸ¶ b) (g : b âŸ¶ c) (h : c âŸ¶ d) (i : d âŸ¶ e) :
  (Î±_ f g (h â‰« i)).hom â‰« f â— (Î±_ g h i).inv â‰« (Î±_ f (g â‰« h) i).inv =
    (Î±_ (f â‰« g) h i).inv â‰« (Î±_ f g h).hom â–· i :=
by { rw [â†cancel_epi (Î±_ f g (h â‰« i)).inv, â†cancel_mono ((Î±_ f g h).inv â–· i)], simp }
@[simp, reassoc]
lemma pentagon_hom_hom_inv_inv_hom (f : a âŸ¶ b) (g : b âŸ¶ c) (h : c âŸ¶ d) (i : d âŸ¶ e) :
  (Î±_ f (g â‰« h) i).hom â‰« f â— (Î±_ g h i).hom â‰« (Î±_ f g (h â‰« i)).inv =
    (Î±_ f g h).inv â–· i â‰« (Î±_ (f â‰« g) h i).hom :=
eq_of_inv_eq_inv (by simp)
@[simp, reassoc]
lemma pentagon_inv_hom_hom_hom_hom (f : a âŸ¶ b) (g : b âŸ¶ c) (h : c âŸ¶ d) (i : d âŸ¶ e) :
  (Î±_ f g h).inv â–· i â‰« (Î±_ (f â‰« g) h i).hom â‰« (Î±_ f g (h â‰« i)).hom =
    (Î±_ f (g â‰« h) i).hom â‰« f â— (Î±_ g h i).hom :=
by simp [â†cancel_epi ((Î±_ f g h).hom â–· i)]
@[simp, reassoc]
lemma pentagon_inv_inv_hom_inv_inv (f : a âŸ¶ b) (g : b âŸ¶ c) (h : c âŸ¶ d) (i : d âŸ¶ e) :
  (Î±_ f g (h â‰« i)).inv â‰« (Î±_ (f â‰« g) h i).inv â‰« (Î±_ f g h).hom â–· i =
    f â— (Î±_ g h i).inv â‰« (Î±_ f (g â‰« h) i).inv :=
eq_of_inv_eq_inv (by simp)
lemma triangle_assoc_comp_left (f : a âŸ¶ b) (g : b âŸ¶ c) :
  (Î±_ f (ğŸ™ b) g).hom â‰« f â— (Î»_ g).hom = (Ï_ f).hom â–· g :=
triangle f g
@[simp, reassoc]
lemma triangle_assoc_comp_right (f : a âŸ¶ b) (g : b âŸ¶ c) :
  (Î±_ f (ğŸ™ b) g).inv â‰« (Ï_ f).hom â–· g = f â— (Î»_ g).hom :=
by rw [â†triangle, inv_hom_id_assoc]
@[simp, reassoc]
lemma triangle_assoc_comp_right_inv (f : a âŸ¶ b) (g : b âŸ¶ c) :
  (Ï_ f).inv â–· g â‰« (Î±_ f (ğŸ™ b) g).hom = f â— (Î»_ g).inv :=
by simp [â†cancel_mono (f â— (Î»_ g).hom)]
@[simp, reassoc]
lemma triangle_assoc_comp_left_inv (f : a âŸ¶ b) (g : b âŸ¶ c) :
  f â— (Î»_ g).inv â‰« (Î±_ f (ğŸ™ b) g).inv = (Ï_ f).inv â–· g :=
by simp [â†cancel_mono ((Ï_ f).hom â–· g)]
@[reassoc]
lemma associator_naturality_left {f f' : a âŸ¶ b} (Î· : f âŸ¶ f') (g : b âŸ¶ c) (h : c âŸ¶ d) :
  (Î· â–· g) â–· h â‰« (Î±_ f' g h).hom = (Î±_ f g h).hom â‰« Î· â–· (g â‰« h) :=
by simp
@[reassoc]
lemma associator_inv_naturality_left {f f' : a âŸ¶ b} (Î· : f âŸ¶ f') (g : b âŸ¶ c) (h : c âŸ¶ d) :
  Î· â–· (g â‰« h) â‰« (Î±_ f' g h).inv = (Î±_ f g h).inv â‰« (Î· â–· g) â–· h :=
by simp
@[reassoc]
lemma whisker_right_comp_symm {f f' : a âŸ¶ b} (Î· : f âŸ¶ f') (g : b âŸ¶ c) (h : c âŸ¶ d) :
  (Î· â–· g) â–· h = (Î±_ f g h).hom â‰« Î· â–· (g â‰« h) â‰« (Î±_ f' g h).inv :=
by simp
@[reassoc]
lemma associator_naturality_middle (f : a âŸ¶ b) {g g' : b âŸ¶ c} (Î· : g âŸ¶ g') (h : c âŸ¶ d) :
  (f â— Î·) â–· h â‰« (Î±_ f g' h).hom = (Î±_ f g h).hom â‰« f â— (Î· â–· h) :=
by simp
@[reassoc]
lemma associator_inv_naturality_middle (f : a âŸ¶ b) {g g' : b âŸ¶ c} (Î· : g âŸ¶ g') (h : c âŸ¶ d) :
  f â— (Î· â–· h) â‰« (Î±_ f g' h).inv = (Î±_ f g h).inv â‰« (f â— Î·) â–· h :=
by simp
@[reassoc]
lemma whisker_assoc_symm (f : a âŸ¶ b) {g g' : b âŸ¶ c} (Î· : g âŸ¶ g') (h : c âŸ¶ d) :
  f â— (Î· â–· h) = (Î±_ f g h).inv â‰« (f â— Î·) â–· h â‰« (Î±_ f g' h).hom :=
by simp
@[reassoc]
lemma associator_naturality_right (f : a âŸ¶ b) (g : b âŸ¶ c) {h h' : c âŸ¶ d} (Î· : h âŸ¶ h') :
  (f â‰« g) â— Î· â‰« (Î±_ f g h').hom = (Î±_ f g h).hom â‰« f â— (g â— Î·) :=
by simp
@[reassoc]
lemma associator_inv_naturality_right (f : a âŸ¶ b) (g : b âŸ¶ c) {h h' : c âŸ¶ d} (Î· : h âŸ¶ h') :
  f â— (g â— Î·) â‰« (Î±_ f g h').inv = (Î±_ f g h).inv â‰« (f â‰« g) â— Î· :=
by simp
@[reassoc]
lemma comp_whisker_left_symm (f : a âŸ¶ b) (g : b âŸ¶ c) {h h' : c âŸ¶ d} (Î· : h âŸ¶ h') :
  f â— (g â— Î·) = (Î±_ f g h).inv â‰« (f â‰« g) â— Î· â‰« (Î±_ f g h').hom :=
by simp
@[reassoc]
lemma left_unitor_naturality {f g : a âŸ¶ b} (Î· : f âŸ¶ g) :
  ğŸ™ a â— Î· â‰« (Î»_ g).hom = (Î»_ f).hom â‰« Î· :=
by simp
@[reassoc]
lemma left_unitor_inv_naturality {f g : a âŸ¶ b} (Î· : f âŸ¶ g) :
  Î· â‰« (Î»_ g).inv = (Î»_ f).inv â‰« ğŸ™ a â— Î· :=
by simp
lemma id_whisker_left_symm {f g : a âŸ¶ b} (Î· : f âŸ¶ g) :
  Î· = (Î»_ f).inv â‰« ğŸ™ a â— Î· â‰« (Î»_ g).hom :=
by simp
@[reassoc]
lemma right_unitor_naturality {f g : a âŸ¶ b} (Î· : f âŸ¶ g) :
  Î· â–· ğŸ™ b â‰« (Ï_ g).hom = (Ï_ f).hom â‰« Î· :=
by simp
@[reassoc]
lemma right_unitor_inv_naturality {f g : a âŸ¶ b} (Î· : f âŸ¶ g) :
  Î· â‰« (Ï_ g).inv = (Ï_ f).inv â‰« Î· â–· ğŸ™ b :=
by simp
lemma whisker_right_id_symm {f g : a âŸ¶ b} (Î· : f âŸ¶ g) :
  Î· = (Ï_ f).inv â‰« Î· â–· ğŸ™ b â‰« (Ï_ g).hom :=
by simp
lemma whisker_left_iff {f g : a âŸ¶ b} (Î· Î¸ : f âŸ¶ g) :
  (ğŸ™ a â— Î· = ğŸ™ a â— Î¸) â†” (Î· = Î¸) :=
by simp
lemma whisker_right_iff {f g : a âŸ¶ b} (Î· Î¸ : f âŸ¶ g) :
  (Î· â–· ğŸ™ b = Î¸ â–· ğŸ™ b) â†” (Î· = Î¸) :=
by simp
@[reassoc, simp]
lemma left_unitor_whisker_right (f : a âŸ¶ b) (g : b âŸ¶ c) :
  (Î»_ f).hom â–· g = (Î±_ (ğŸ™ a) f g).hom â‰« (Î»_ (f â‰« g)).hom :=
by rw [â†whisker_left_iff, whisker_left_comp, â†cancel_epi (Î±_ _ _ _).hom,
  â†cancel_epi ((Î±_ _ _ _).hom â–· _), pentagon_assoc, triangle,
  â†associator_naturality_middle, â†comp_whisker_right_assoc, triangle,
  associator_naturality_left]; apply_instance
@[reassoc, simp]
lemma left_unitor_inv_whisker_right (f : a âŸ¶ b) (g : b âŸ¶ c) :
  (Î»_ f).inv â–· g = (Î»_ (f â‰« g)).inv â‰« (Î±_ (ğŸ™ a) f g).inv :=
eq_of_inv_eq_inv (by simp)
@[reassoc, simp]
lemma whisker_left_right_unitor (f : a âŸ¶ b) (g : b âŸ¶ c) :
  f â— (Ï_ g).hom = (Î±_ f g (ğŸ™ c)).inv â‰« (Ï_ (f â‰« g)).hom :=
by rw [â†whisker_right_iff, comp_whisker_right, â†cancel_epi (Î±_ _ _ _).inv,
  â†cancel_epi (f â— (Î±_ _ _ _).inv), pentagon_inv_assoc, triangle_assoc_comp_right,
  â†associator_inv_naturality_middle, â†whisker_left_comp_assoc, triangle_assoc_comp_right,
  associator_inv_naturality_right]; apply_instance
@[reassoc, simp]
lemma whisker_left_right_unitor_inv (f : a âŸ¶ b) (g : b âŸ¶ c) :
  f â— (Ï_ g).inv = (Ï_ (f â‰« g)).inv â‰« (Î±_ f g (ğŸ™ c)).hom :=
eq_of_inv_eq_inv (by simp)
@[reassoc]
lemma left_unitor_comp (f : a âŸ¶ b) (g : b âŸ¶ c) :
  (Î»_ (f â‰« g)).hom = (Î±_ (ğŸ™ a) f g).inv â‰« (Î»_ f).hom â–· g :=
by simp
@[reassoc]
lemma left_unitor_comp_inv (f : a âŸ¶ b) (g : b âŸ¶ c) :
  (Î»_ (f â‰« g)).inv = (Î»_ f).inv â–· g â‰« (Î±_ (ğŸ™ a) f g).hom :=
by simp
@[reassoc]
lemma right_unitor_comp (f : a âŸ¶ b) (g : b âŸ¶ c) :
  (Ï_ (f â‰« g)).hom = (Î±_ f g (ğŸ™ c)).hom â‰« f â— (Ï_ g).hom :=
by simp
@[reassoc]
lemma right_unitor_comp_inv (f : a âŸ¶ b) (g : b âŸ¶ c) :
  (Ï_ (f â‰« g)).inv = f â— (Ï_ g).inv â‰« (Î±_ f g (ğŸ™ c)).inv :=
by simp
@[simp]
lemma unitors_equal : (Î»_ (ğŸ™ a)).hom = (Ï_ (ğŸ™ a)).hom :=
by rw [â†whisker_left_iff, â†cancel_epi (Î±_ _ _ _).hom, â†cancel_mono (Ï_ _).hom, triangle,
  â†right_unitor_comp, right_unitor_naturality]; apply_instance
@[simp]
lemma unitors_inv_equal : (Î»_ (ğŸ™ a)).inv = (Ï_ (ğŸ™ a)).inv :=
by simp [iso.inv_eq_inv]
end bicategory
end category_theory
